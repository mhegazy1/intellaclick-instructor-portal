import{t as r}from"./toast-93yYkT8V.js";/* empty css               *//* empty css                       */import{q as h}from"./api-BBvzFwfC.js";import{l as p}from"./logger-gSLuc3Ra.js";let c=[];document.addEventListener("DOMContentLoaded",function(){v(),document.getElementById("quizForm").addEventListener("submit",q),g()});function v(){localStorage.getItem("token")||(window.location.href="login.html")}function g(){const e=document.getElementById("questionType").value;switch(document.getElementById("mcqOptions").style.display="none",document.getElementById("pollOptions").style.display="none",document.getElementById("tfOptions").style.display="none",document.getElementById("matchingOptions").style.display="none",document.getElementById("orderingOptions").style.display="none",document.getElementById("fillblankOptions").style.display="none",e){case"mcq":document.getElementById("mcqOptions").style.display="block";break;case"poll":document.getElementById("pollOptions").style.display="block";break;case"tf":document.getElementById("tfOptions").style.display="block";break;case"matching":document.getElementById("matchingOptions").style.display="block";break;case"ordering":document.getElementById("orderingOptions").style.display="block";break;case"fillblank":document.getElementById("fillblankOptions").style.display="block";break}}function b(){const e=document.getElementById("questionType").value,t=document.getElementById("questionText").value.trim();if(!t){r.error("Please enter a question");return}let n={questionText:t,questionType:e,points:10};try{switch(e){case"mcq":const o=[];let a=null;if(["A","B","C","D"].forEach(i=>{const l=document.getElementById(`option${i}`);if(l&&l.value.trim()){o.push(l.value.trim());const u=document.querySelector(`input[name="correctAnswer"][value="${i}"]`);u&&u.checked&&(a=i)}}),o.length<2){r.error("Please provide at least 2 answer options");return}n.options=o,n.correctAnswer=a;break;case"poll":const s=[];if(["A","B","C","D"].forEach(i=>{const l=document.getElementById(`pollOption${i}`);l&&l.value.trim()&&s.push(l.value.trim())}),s.length<2){r.error("Please provide at least 2 poll options");return}n.options=s;break;case"tf":n.options=["True","False"],n.correctAnswer=document.querySelector('input[name="tfAnswer"]:checked').value;break;case"matching":const d=[];for(let i=1;i<=4;i++){const l=document.getElementById(`match${i}Left`).value.trim(),u=document.getElementById(`match${i}Right`).value.trim();l&&u&&d.push({left:l,right:u})}if(d.length<2){r.error("Please provide at least 2 matching pairs");return}n.pairs=d;break;case"ordering":const m=[];for(let i=1;i<=4;i++){const l=document.getElementById(`order${i}`).value.trim();l&&m.push(l)}if(m.length<2){r.error("Please provide at least 2 items to order");return}n.correctOrder=m;break;case"fillblank":const y=document.getElementById("blankAnswer").value.trim();if(!y){r.error("Please provide the correct answer");return}if(!t.includes("[blank]")){r.error("Please include [blank] in your question where the answer should go");return}n.correctAnswer=y;break}c.push(n),w(),f(),r.success("Question added successfully!")}catch(o){p.error("Error adding question:",o),r.error("Error adding question: "+o.message)}}function w(){document.getElementById("questionText").value="",["A","B","C","D"].forEach(t=>{const n=document.getElementById(`option${t}`);n&&(n.value="");const o=document.getElementById(`pollOption${t}`);o&&(o.value="")});for(let t=1;t<=4;t++){const n=document.getElementById(`match${t}Left`),o=document.getElementById(`match${t}Right`),a=document.getElementById(`order${t}`);n&&(n.value=""),o&&(o.value=""),a&&(a.value="")}const e=document.getElementById("blankAnswer");e&&(e.value="")}function B(e){window.confirm("Remove this question?")&&(c.splice(e,1),f(),r.success("Question removed"))}function f(){const e=document.getElementById("questionsList");if(c.length===0){e.innerHTML='<p style="color: var(--text-secondary); font-size: 14px;">No questions added yet.</p>';return}e.innerHTML=`
                <div style="margin-bottom: 12px;">
                    <strong>${c.length} Question(s) Added:</strong>
                </div>
                ${c.map((t,n)=>`
                    <div style="background-color: #F9FAFB; padding: 12px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: start;">
                        <div style="flex: 1;">
                            <div style="font-weight: 500; margin-bottom: 4px;">Q${n+1}: ${t.questionText}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Type: ${E(t.questionType)}</div>
                        </div>
                        <button type="button" class="btn btn-danger btn-small" onclick="removeQuestion(${n})" style="margin-left: 12px;">Remove</button>
                    </div>
                `).join("")}
            `}function E(e){return{mcq:"Multiple Choice",poll:"Poll",tf:"True/False",matching:"Matching",ordering:"Put in Order",fillblank:"Fill in the Blank"}[e]||e.toUpperCase()}async function q(e){e.preventDefault();const t=document.getElementById("quizTitle").value.trim(),n=document.getElementById("quizDescription").value.trim();if(!t){r.error("Please enter a quiz title");return}if(c.length===0){r.error("Please add at least one question to the quiz");return}const o=c.map(s=>({questionSnapshot:{questionText:s.questionText,questionType:s.questionType,options:s.options,correctAnswer:s.correctAnswer,pairs:s.pairs,correctOrder:s.correctOrder},points:s.points||10})),a={title:t,description:n,type:"standard",questions:o,questionCount:o.length,settings:{shuffleQuestions:!1,shuffleAnswers:!1,showCorrectAnswers:!0}};try{document.getElementById("saveButton").disabled=!0,document.getElementById("saveButton").textContent="Saving...";const s=await h.create(a);p.debug("Quiz created:",s),r.success("Quiz saved successfully!"),setTimeout(()=>{window.location.href="quizzes.html"},1e3)}catch(s){p.error("Error saving quiz:",s),r.error("Failed to save quiz: "+s.message),document.getElementById("saveButton").disabled=!1,document.getElementById("saveButton").textContent="Save Quiz"}}function k(){c.length>0?window.confirm("Are you sure you want to cancel? All unsaved changes will be lost.")&&(window.location.href="quizzes.html"):window.location.href="quizzes.html"}function I(){const e=document.getElementById("questionText"),t=e.selectionStart,n=e.selectionEnd,o=e.value,a=o.substring(0,t)+"[blank]"+o.substring(n);e.value=a,e.selectionStart=e.selectionEnd=t+7,e.focus()}window.updateQuestionOptions=g;window.addQuestion=b;window.removeQuestion=B;window.cancelQuiz=k;window.insertBlank=I;
