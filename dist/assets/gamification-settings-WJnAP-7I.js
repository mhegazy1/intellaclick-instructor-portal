import{t as s}from"./toast-CsVVNeTg.js";/* empty css               */import{c as p,g as h}from"./api-Cc5qfUA_.js";import{l as r}from"./logger-CifuMjS_.js";let l=null,c={},m=null;r.debug("ðŸ”µ Gamification Settings Page Loaded - Version 1.0.0-modular");document.addEventListener("DOMContentLoaded",async()=>{await w(),await y()});async function w(){localStorage.getItem("token")||(window.location.href="login.html")}async function y(){try{const a=(await p.getAll()).classes||[],o=document.getElementById("scopeSelector");a.forEach(t=>{const n=document.createElement("option");n.value=t._id||t.id,n.textContent=t.name,o.appendChild(n)})}catch(e){r.error("Error loading classes:",e),s.error("Failed to load classes")}}async function E(){const e=document.getElementById("scopeSelector").value;if(!e){s.info("Please select a class to configure its settings");return}l=e,await S()}async function S(){if(l)try{c=(await h.getSettings(l)).settings||g(),v(c),s.success("Settings loaded")}catch(e){r.error("Error loading settings:",e),c=g(),v(c),s.warning("Using default settings")}}function g(){return{enabled:!0,showLeaderboard:!0,showAchievements:!0,points:{base:10,speedBonus:.5,streakBonus:5},levels:{enabled:!0,pointsPerLevel:100,maxLevel:50},achievements:{enabled:!0}}}function v(e){var a,o,t,n,i,d,u;document.getElementById("enabled").checked=e.enabled,document.getElementById("showLeaderboard").checked=e.showLeaderboard,document.getElementById("showAchievements").checked=e.showAchievements,document.getElementById("basePoints").value=((a=e.points)==null?void 0:a.base)||10,document.getElementById("speedBonus").value=((o=e.points)==null?void 0:o.speedBonus)||.5,document.getElementById("streakBonus").value=((t=e.points)==null?void 0:t.streakBonus)||5,document.getElementById("levelsEnabled").checked=((n=e.levels)==null?void 0:n.enabled)||!0,document.getElementById("pointsPerLevel").value=((i=e.levels)==null?void 0:i.pointsPerLevel)||100,document.getElementById("maxLevel").value=((d=e.levels)==null?void 0:d.maxLevel)||50,document.getElementById("achievementsEnabled").checked=((u=e.achievements)==null?void 0:u.enabled)||!0}function B(e,a){const o=e.split(".");let t=c;for(let n=0;n<o.length-1;n++)t[o[n]]||(t[o[n]]={}),t=t[o[n]];t[o[o.length-1]]=a,clearTimeout(m),m=setTimeout(()=>{f()},1e3)}async function f(){if(!l){s.warning("Please select a class first");return}try{await h.updateSettings(l,c),I(),s.success("Settings saved successfully!")}catch(e){r.error("Error saving settings:",e),s.error(`Failed to save settings: ${e.message}`)}}function I(){const e=document.getElementById("saveIndicator");e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},3e3)}function L(e){document.querySelectorAll(".settings-panel").forEach(a=>{a.classList.remove("active")}),document.getElementById(e).classList.add("active"),document.querySelectorAll(".nav-item").forEach(a=>{a.classList.remove("active")}),event.target.closest(".nav-item").classList.add("active")}window.handleScopeChange=E;window.saveSetting=B;window.saveToServer=f;window.showPanel=L;
