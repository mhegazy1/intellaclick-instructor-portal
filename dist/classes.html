<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="version" content="2.0.0-modular">
    <title>My Classes - IntellaClick</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script type="module" crossorigin src="/assets/classes-oUSPlQCy.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/toast-93yYkT8V.js">
  <link rel="stylesheet" crossorigin href="/assets/classes-BFzGPYGm.css">
  <link rel="stylesheet" crossorigin href="/assets/common-ABeTdMwf.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>My Classes</h1>
                <p>Manage your classes and track student engagement</p>
            </div>
            <div class="header-actions">
                <div class="welcome-message">
                    Welcome, <span class="welcome-name" id="userName">Instructor</span>
                </div>
                <button class="btn-logout" onclick="handleLogout()">Logout</button>
            </div>
        </div>

        <!-- Filters Section -->
        <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <div style="display: flex; justify-content: space-between; align-items: center; gap: 16px; flex-wrap: wrap;">
                <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                    <label style="font-weight: 500; color: var(--text-secondary);">Filters:</label>

                    <select id="yearFilter" onchange="applyFilters()" style="width: auto; padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px; background: white; font-size: 14px;">
                        <option value="">All Years</option>
                    </select>

                    <select id="semesterFilter" onchange="applyFilters()" style="width: auto; padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px; background: white; font-size: 14px;">
                        <option value="">All Semesters</option>
                        <option value="Spring">Spring</option>
                        <option value="Summer">Summer</option>
                        <option value="Fall">Fall</option>
                        <option value="Winter">Winter</option>
                    </select>

                    <select id="statusFilter" onchange="applyFilters()" style="width: auto; padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px; background: white; font-size: 14px;">
                        <option value="active">Active Classes</option>
                        <option value="">All Classes</option>
                        <option value="archived">Archived</option>
                    </select>

                    <select id="classFilter" onchange="applyFilters()" style="width: auto; padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px; background: white; font-size: 14px; display: none;">
                        <option value="">All Classes</option>
                    </select>
                </div>

                <button class="btn btn-secondary" onclick="clearFilters()" style="padding: 8px 16px;">
                    Clear Filters
                </button>
            </div>
        </div>

        <div class="stats-overview">
            <div class="stat-card">
                <div class="stat-icon blue">üìö</div>
                <div class="stat-content">
                    <h3 id="totalClasses">0</h3>
                    <p>Total Classes</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon green">üë•</div>
                <div class="stat-content">
                    <h3 id="totalStudents">0</h3>
                    <p>Total Students</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon purple">üéØ</div>
                <div class="stat-content">
                    <h3 id="totalSessions">0</h3>
                    <p>Total Sessions</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon yellow">üìä</div>
                <div class="stat-content">
                    <h3 id="avgEngagement">0%</h3>
                    <p>Avg. Engagement</p>
                </div>
            </div>
        </div>

        <div class="actions-bar">
            <div style="display: flex; gap: 12px;">
                <button class="btn btn-primary" onclick="showCreateClassModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    Create New Class
                </button>
                <a href="quizzes.html" class="btn btn-secondary">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    My Quizzes
                </a>
                <a href="active-sessions.html" class="btn btn-primary" style="background-color: var(--secondary-color);">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    üî¥ Active Sessions
                </a>
                <a href="session-history.html" class="btn btn-secondary">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    üìä Session History
                </a>
                <a href="gamification-dashboard.html" class="btn btn-secondary">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                    </svg>
                    üèÜ Gamification
                </a>
            </div>
        </div>

        <div id="classesContainer" class="classes-grid">
            <div class="loading">Loading your classes...</div>
        </div>
    </div>

    <!-- Create/Edit Class Modal -->
    <div id="classModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Create New Class</h2>
                <p>Set up a new class for your students</p>
            </div>
            <form id="classForm">
                <div class="form-group">
                    <label for="className">Class Name *</label>
                    <input type="text" id="className" required placeholder="e.g., Introduction to Psychology">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="classCode">Course Code *</label>
                        <input type="text" id="classCode" required placeholder="e.g., PSY101">
                    </div>
                    <div class="form-group">
                        <label for="classSection">Section</label>
                        <input type="text" id="classSection" placeholder="e.g., 001">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="termSeason">Term Season *</label>
                        <select id="termSeason" required>
                            <option value="">Select Season</option>
                            <option value="Spring">Spring</option>
                            <option value="Summer">Summer</option>
                            <option value="Fall">Fall</option>
                            <option value="Winter">Winter</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="termYear">Term Year *</label>
                        <select id="termYear" required>
                            <option value="">Select Year</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="classDescription">Description</label>
                    <textarea id="classDescription" placeholder="Brief description of the class (optional)"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="startDate">Start Date *</label>
                        <input type="date" id="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="endDate">End Date *</label>
                        <input type="date" id="endDate" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="customJoinCode">Custom Join Code (Optional)</label>
                    <input type="text"
                           id="customJoinCode"
                           placeholder="Leave empty for auto-generated code"
                           maxlength="12"
                           pattern="[A-Za-z0-9]{4,12}"
                           title="4-12 characters, letters and numbers only"
                           style="text-transform: uppercase;"
                           oninput="this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '')">
                    <small style="color: #6B7280; display: block; margin-top: 4px;">
                        4-12 characters, letters and numbers only. Leave empty for auto-generated code.
                    </small>
                </div>

                <div class="form-group">
                    <label for="enrollmentLimit">Enrollment Limit (Optional)</label>
                    <input type="number"
                           id="enrollmentLimit"
                           placeholder="Leave empty for no limit"
                           min="1"
                           step="1">
                    <small style="color: #6B7280; display: block; margin-top: 4px;">
                        Maximum number of students allowed to enroll. Leave empty for unlimited enrollment.
                    </small>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="hideModal('classModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Class</button>
                </div>
            </form>
        </div>
    </div>



    <!-- QR Code Modal -->
    <div id="qrModal" class="qr-modal" onclick="if(event.target === this) closeQRModal()">
        <div class="qr-modal-content">
            <button class="modal-close" onclick="closeQRModal()">&times;</button>
            
            <div class="qr-modal-header">
                <h2>Join Class with QR Code</h2>
                <p>Students can scan this code to join <strong id="qrClassName"></strong></p>
            </div>
            
            <div class="join-code-large" id="qrJoinCode"></div>
            
            <div class="qr-code-container" id="qrCodeContainer"></div>
            
            <div class="join-url-section" id="qrJoinUrl" title="Click to copy"></div>
            
            <div class="qr-instructions">
                <h3>How students can join:</h3>
                <ol>
                    <li>Open camera app on their phone</li>
                    <li>Point at the QR code above</li>
                    <li>Tap the notification that appears</li>
                    <li>Sign in or register on the join page</li>
                </ol>
                <p style="margin-top: 12px; font-size: 14px; color: #4b5563;">
                    Alternatively, they can visit the URL above and enter the join code manually.
                </p>
            </div>
            
            <div style="margin-top: 24px;">
                <button class="btn btn-primary" onclick="closeQRModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Edit Class Modal -->
    <div id="editClassModal" class="modal" onclick="if(event.target === this) closeEditClassModal()">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Class Settings</h2>
                <p style="color: var(--text-secondary); font-size: 14px;">Update class information</p>
            </div>

            <form id="editClassForm" onsubmit="saveClassEdits(event)">
                <div class="form-group">
                    <label for="editClassName">Class Name *</label>
                    <input type="text" id="editClassName" required placeholder="e.g., Introduction to Psychology">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editClassCode">Course Code *</label>
                        <input type="text" id="editClassCode" required placeholder="e.g., PSY101">
                    </div>
                    <div class="form-group">
                        <label for="editClassSection">Section</label>
                        <input type="text" id="editClassSection" placeholder="e.g., 001">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editTermSeason">Term Season *</label>
                        <select id="editTermSeason" required>
                            <option value="">Select Season</option>
                            <option value="Spring">Spring</option>
                            <option value="Summer">Summer</option>
                            <option value="Fall">Fall</option>
                            <option value="Winter">Winter</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editTermYear">Term Year *</label>
                        <select id="editTermYear" required>
                            <option value="">Select Year</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="editClassDescription">Description</label>
                    <textarea id="editClassDescription" placeholder="Brief description of the class (optional)"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editStartDate">Start Date *</label>
                        <input type="date" id="editStartDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editEndDate">End Date *</label>
                        <input type="date" id="editEndDate" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="editCustomJoinCode">Custom Join Code</label>
                    <input type="text"
                           id="editCustomJoinCode"
                           placeholder="Current code will be kept if empty"
                           maxlength="12"
                           pattern="[A-Za-z0-9]{4,12}"
                           title="4-12 characters, letters and numbers only"
                           style="text-transform: uppercase;"
                           oninput="this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '')">
                    <small style="color: #6B7280; display: block; margin-top: 4px;">
                        4-12 characters, letters and numbers only. Leave empty to keep current code.
                    </small>
                </div>

                <div class="form-group">
                    <label for="editEnrollmentLimit">Enrollment Limit (Optional)</label>
                    <input type="number"
                           id="editEnrollmentLimit"
                           placeholder="Leave empty for no limit"
                           min="1"
                           step="1">
                    <small style="color: #6B7280; display: block; margin-top: 4px;">
                        Maximum number of students allowed to enroll. Leave empty for unlimited enrollment.
                    </small>
                </div>

                <input type="hidden" id="editClassId">

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeEditClassModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

</body>
</html>
